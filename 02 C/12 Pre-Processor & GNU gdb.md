
## Pre-Processor 
- **#define**
- **#undef**
- **concatenation operator (##)** : concatenates, or joins, two strings in the macro expansion
- #if, #elif, #else, & #endif : control conditional compilation
- **conditional selection using #ifdef, #else and #endif**


## GNU gdb
- Debug programs written in C and C++
- Allows you to see inside another program
- Functions like an interpreter
- Start, stop, examine, and change your program during execution

### Invoking gdb

   ```c
$ gcc -g debug_me.c -o debug_me // compile your program with the `-g` flag
$ gdb debug_me // start gdb
(gdb) break main // set a breakpoint at main
(gdb) break main // run the program
   ```

### gdb commands

```c
(gdb) help // to get a list of commands
(gdb) kill // stop
(gdb) quit // exit
(gdb) continue // continue
	
gdb programname // start debugger with program name
(gdb) run arg1 "arg2" // start execution
	
(gdb) kill // kill
(gdb) run  // restart

(gdb) set x = 3
(gdb) print x

(gdb) next // go over function calls
(gdb) step // go into function calls
(gdb) call abort() // call function
      
(gdb) backtrace // view backtrace
(gdb) frame 2 // change stack frames

// set breakpoints
(gdb) break 19
(gdb) break test.c:19
(gdb) break func1
(gdb) info breakpoints // list breakpoints

(gdb) watch x // set watchpoint
(gdb) disable 4 // disable watchpoint
```

### Breakpoints

- A fundamental debugging tool used to pause the execution of a program at a specific point
- This allows developers to inspect the state of the program, including variable values and the call stack, at that exact location

### Watchpoints
- A type of breakpoint that pauses the execution of a program when the value of a specified variable changes
- This is particularly useful for tracking down bugs that occur due to unexpected changes in variable values

### GNU - Makefile

- A makefile is a special file, typically named `Makefile`
- It contains a set of directives used by the `make` build automation tool to compile and build programs
- It specifies how to derive the target program from the source files

- **Naming Makefiles**  
	- Default names: `GNUmakefile`, `makefile`, `Makefile`
	- Use `-f` or `--file` option for nonstandard names

- **Processing Makefiles**  
	- **Phase-1 :** Read files, expand variables/functions, process directives, construct dependency graph.  
	- **Phase-2 :** Determine targets to rebuild, invoke rules 

-  Structure/Components of Makefile
1. **Targets**
	- Usually a file generated by a program
	- The output files or actions to be performed, such as executables or object files
	- A target can also be an action, like `clean`

2. **Prerequisites** 
	- Input files for the target
	- Files or conditions that must be satisfied before the target can be built
	- These are usually source files that need to be compiled

3. **Recipes**
	- Commands to create the target (tab-indented)
	- The commands to be executed to build the target from the prerequisites
	- These commands are typically shell commands

4. **Rules** 
	- Each rule in a makefile consists of a target, prerequisites, and a recipe
	- **Explicit Rules :** Specify prerequisites for a specific target
	- **Implicit Rules :** Utilize known patterns (e.g., .c to .o).
	- structure of Rule  
   ```makefile  
   target: prerequisites  
       recipe  
   ```

5. **Variables**
	- Store values that can be used throughout the makefile to avoid repetition and make the file easier to maintain
	- Defining Variables
```makefile
$ make VAR1=abc VAR2=xyz // command-line
override VAR1=dummy      // override directive to prevent redefinitions
```

**Automatic Variables**  
- Set by make after a rule is matched
- `$@`: Target filename
- `$*`: Target filename without extension
- `$<`: First prerequisite filename
- `$^`: All prerequisite filenames, no duplicates
- `$+`: All prerequisite filenames, includes duplicates  
- `$?`: Newer prerequisites than the target

### Example - Makefile

1. example of a simple makefile
```makefile  
# Variables  
CC = gcc  
CFLAGS = -Wall -g

# Targets and rules  
all: myprogram

myprogram: main.o utils.o  
    $(CC) $(CFLAGS) -o myprogram main.o utils.o

main.o: main.c  
    $(CC) $(CFLAGS) -c main.c

utils.o: utils.c  
    $(CC) $(CFLAGS) -c utils.c

clean:  
    rm -f myprogram main.o utils.o  
```

- **Variables**
	- `CC` and `CFLAGS` are defined to specify the compiler and flags used during compilation
- **all**
	- A target that depends on `myprogram`
	- This target is usually the default target when `make` is run without arguments  
- **myprogram**
	- Depends on `main.o` and `utils.o`
	- The recipe combines these object files into the final executable
- **main.o** and **utils.o**
	- These are object files generated from their respective source files
- **clean**
	- A special target to remove generated files, which helps to clean up the build environment


2. example2 Makefile
```makefile  
edit : main.o kbd.o command.o display.o \  
       insert.o search.o files.o utils.o  
        cc -o edit main.o kbd.o command.o display.o \  
                   insert.o search.o files.o utils.o  
  
main.o : main.c defs.h  
        cc -c main.c  
kbd.o : kbd.c defs.h command.h  
        cc -c kbd.c  
command.o : command.c defs.h command.h  
        cc -c command.c  
display.o : display.c defs.h buffer.h  
        cc -c display.c  
insert.o : insert.c defs.h buffer.h  
        cc -c insert.c  
search.o : search.c defs.h buffer.h  
        cc -c search.c  
files.o : files.c defs.h buffer.h command.h  
        cc -c files.c  
utils.o : utils.c defs.h  
        cc -c utils.c  
clean :  
        rm edit main.o kbd.o command.o display.o \  
           insert.o search.o files.o utils.o  
```

3. example3 with Automatic Variables  
```makefile  
all: hello.exe

hello.exe: hello.o  
    gcc -o $@ $<

hello.o: hello.c  
    gcc -c $<

clean:  
    rm hello.o hello.exe  
```


### CASE STUDY - Makefile
Write functions to find Area and Perimeter of following Triangles in each files 
- An equilateral triangle
- An isosceles triangle
- A right-angled triangle
- A scalene triangle
Write main function in main.c & Write a makefile for this project

- equilateral_triangle.c
```c 
#include <math.h>

double equilateral_area(double side) {
    return (sqrt(3) / 4) * side * side;
}

double equilateral_perimeter(double side) {
    return 3 * side;
}
```

- equilateral_triangle.h
```c
#ifndef EQUILATERAL_TRIANGLE_H
#define EQUILATERAL_TRIANGLE_H

double equilateral_area(double side);
double equilateral_perimeter(double side);

#endif // EQUILATERAL_TRIANGLE_H
```

- isosceles_triangle.c
```c
#include <math.h>

double isosceles_area(double base, double side) {
	double height = sqrt(side * side - (base * base /4));
	return (base * height) / 2;
}

double isosceles_perimeter(double base, double side){
	return 2* side + base;
}
```

- isosceles_triangle.h
```c
#ifndef ISOSCELES_TRIANGLE_H
#define ISOSCELES_TRIANGLE_H

double isosceles_area(double base, double side);
double isosceles_perimeter(double base, double side);

#endif // ISOSCELES_TRIANGLE_H
```

- right_angled_triangle.c
```c
#include <math.h>

double right_angled_area(double base, double height){
	return ( base + height ) / 2;
}

double right_angled_perimeter(double base, double height){
	double hypotenuse = sqrt(base * base + height * height);
	return base + height + hypotenuse;
}
```

- right_angled_triangle.h
```c
#ifndef RIGHT_ANGLED_TRIANGLE_H
#define RIGHT_ANGLED_TRIANGLE_H

double right_angled_area(double base, double height);
double right_angled_perimeter(double base, double height);

#endif // RIGHT_ANGLED_TRIANGLE_H
```

- scalene_triangle.c
```c
#include <math.h>

double scalene_area(double a, double b, double c){
	double s =  ( a + b + c ) / 2;
	return sqrt(s * ( s -a ) * ( s - b ) * ( s - c ));
}

double scalene_perimeter(double a, double b, double c){
	return a + b + c;
}
```

- scalene_triangle.h
```c
#ifndef SCALENE_TRIANGLE_H
#define SCALENE_TRIANGLE_H

double scalene_area(double a, double b, double c);
double scalene_perimeter(double a, double b, double c);

#endif // SCALENE_TRIANGLE_H
```

- main.c
```c
#include <stdio.h>
#include "equilateral_triangle.h"
#include "isosceles_triangle.h"
#include "right_angled_triangle.h"
#include "scalene_triangle.h"

int main(){
	double side, base, height, a, b, c;
	printf("Enter side base height a b c = ");
	scanf("%f%f%f%f%f%f",&side,&base,&height,&a,&b,&c);
	
	printf("Equilateral Triangle:\n"); 
	printf("Area: %f\n", equilateral_area(side));
	printf("Perimeter: %f\n\n", equilateral_perimeter(side)); 
	
	printf("Isosceles Triangle:\n"); 
	printf("Area: %f\n", isosceles_area(base, side)); 
	printf("Perimeter: %f\n\n", isosceles_perimeter(base, side)); 
	
	printf("Right-Angled Triangle:\n"); 
	printf("Area: %f\n", right_angled_area(base, height)); 
	printf("Perimeter: %f\n\n", right_angled_perimeter(base, height)); 
	
	printf("Scalene Triangle:\n"); 
	printf("Area: %f\n", scalene_area(a, b, c)); 
	printf("Perimeter: %f\n\n", scalene_perimeter(a, b, c)); 
	
	return 0;
}
```

- Makefile
```makefile
CC = gcc
CFLAGS = -Wall - Werror -std=c99

OBJECTS = main.o equilateral_triangle.o isosceles_triangle.o right_angled_triangle.o scalene_triangle.o

all : triangle_calculator

triangle_calculator : $(OBJECTS)
	$(CC) $(CFLAGS) -o triangle_calculator $(OBJECTS)

main.o : main.c equilateral_triangle.h isosceles_triangle.h right_angled_triangle.h scalene_triangle.h
	$(CC) $(CFLAGS) -c main.c

equilateral_triangle.o : equilateral_traingle.c equilateral_traingle.h 
	$(CC) $(CFLAGS) -c equilateral_triangle.c

isosceles_triangle.o : isosceles_triangle.c isosceles_triangle.h 
	$(CC) $(CFLAGS) -c isosceles_triangle.c 

right_angled_triangle.o : right_angled_triangle.c right_angled_triangle.h 
	$(CC) $(CFLAGS) -c right_angled_triangle.c 
	
scalene_triangle.o : scalene_triangle.c scalene_triangle.h      
	$(CC) $(CFLAGS) -c scalene_triangle.c

clean : 
	rm -f *.o triangle_calculator
```
